<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grow Culture</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="Css/qr_toolpage.css">
    <script type="text/javascript" src="JS/jquery.js"></script>
<script type="text/javascript" src="JS/qrcode.js"></script>
    <!-- <script type="text/javascript" src="qr_t.js"></script> -->
    <!-- <script type="text/javascript" src="JS/dec.js"></script> -->
</head>
<body id="body">
  &nbsp;&nbsp;&nbsp;&nbsp;<h1 style="display: inline-block;">Grow Culture</h1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

    <!-- <button class="button button1">Green</button>
    <button class="button button2">Blue</button> -->
        
    <ul style="display: inline-block;">
        <li><a href="#home">Home</a></li>&nbsp;&nbsp;
        <li><a href="#news">News</a></li>&nbsp;&nbsp;
        <li><a href="#contact">Contact</a></li>&nbsp;&nbsp;
        <li><a href="#about">About</a></li>&nbsp;&nbsp;
    </ul>
    <br><br><br>
    <div id="div1">
        <b>Welcome to  Grow Culture.</b><br><br><br>
        <a href="index.html">
            <i class="fa fa-home" aria-hidden="true"></i><button class="button button1">Create QR Code</button>
        </a>
        <a href="index1.html">
            <i class="fa fa-tachometer" aria-hidden="true"></i><button class="button button2">Scan QR Code</button>
        </a>
    </div>
    <div id="div2">
        <img src="ph1.jfif" alt="" width="50%" height="50%">
    </div>
    <br>
    
    
    
      
    <div class="content-container">
      
        <div class="container-fluid">
      
          <!-- Main component for a primary marketing message or call to action -->        
            <h4 style="color: white;">Choose the file that you want to scan: (Contents will be displayed below)</h4>

            <input type="file" id="file" name="file" onchange="loadFile(event)">
            <br><br>
            
            
            <!-- to print the input image -->

            <img id="output"/>
<script>
  var loadFile = function(event) {
    var output = document.getElementById('output');
    output.src = URL.createObjectURL(event.target.files[0]);
    output.onload = function() {
      URL.revokeObjectURL(output.src) // free memory
    }
  };

  var decoded;
  function decrypt() {
    var e = document.getElementById("content").innerHTML;
    var decodeString = window.atob(e);
    console.log(decodeString)
    document.getElementById("disp").innerHTML = decodeString;
    decoded = decodeString
    // console.log(document.getElementById("content").innerHTML)

}

  getData()
var bigData;
let count = 0;
function getData(){
fetch('http://localhost:3000/user/').then((response)=>{

    return response.text();
}).then((user)=>{
     bigData = JSON.parse(user);
     // console.log(bigData[0].City);
    //console.log(data[0]);

    var items = Array('Chandigarh', 'Delhi', 'Amritsar', 'Ludhiana', 'Gurgaon', 'Rajpura', 'Patiala', 'Mohali')
    var item = items[Math.floor(Math.random()*items.length)];
     for (var i=0;i<9;i++){
      if(bigData[i].farmerID == decoded[0] && count == 0 ){
        
       console.log(bigData[i].farmerName);
       document.getElementById("final1").innerHTML= '<b><u>Point A : </u></b><br>' + 'Farmer Id : '+ bigData[i].farmerID + '<br>'+'Farmer Name : '+ bigData[i].farmerName + '<br>City : ' + bigData[i].city + '<br>State : ' + bigData[i].state + '<br>WhareHouse No. : ' + bigData[i].warehouse + '<br>Time : ' + new Date().toTimeString().split(" ")[0];
       count ++;
       warehouseTime = new Date().toTimeString().split(" ")[0];

      }else if (bigData[i].farmerID == decoded[0] && count == 1){
       document.getElementById("final2").innerHTML='<b><u>Point B : </u></b><br>' +  'Farmer Id : '+ bigData[i].farmerID + '<br>'+'Farmer Name : '+ bigData[i].farmerName + '<br>City : ' + bigData[i].city + '<br>State : ' + bigData[i].state + '<br>WhareHouse No. : ' + bigData[i].warehouse + '<br>Time : ' + warehouseTime +'<br>Location of Distributor : ' + item;
       count ++;
        
      }else if(bigData[i].farmerID == decoded[0] && count == 2){
       deliveryTime = new Date().toTimeString().split(" ")[0];
       document.getElementById("final3").innerHTML='<b><u>Point C : </u></b><br>' +  'Farmer Id : '+ bigData[i].farmerID + '<br>'+'Farmer Name : '+ bigData[i].farmerName + '<br>City : ' + bigData[i].city + '<br>State : ' + bigData[i].state + '<br>WhareHouse No. : ' + bigData[i].warehouse + '<br>Time : ' + warehouseTime +'<br>Location of Distributor : ' + item + '<br>Delivery Time : ' + deliveryTime;
       count ++;
      }
}
})
}

//  let count = 0;
//  var  string = document.getElementById("disp").value;
//  while (count<3){
//     for (var i=0;i<20;i++){
//       console.log(bigData[i].farmerName);
//     }
    
//  }
</script>

<br><br>
<p style="display: none;">Qr Content: <br><span id="content"></span></p>
<button onclick="decrypt(),getData()">Decrypt</button>
<br>
<span id="disp"></span><br><br>
<div style="display: flex;" id="final">
  <span id="final1" class="final"></span>
  <span id="final2" class="final"></span>
  <span id="final3" class="final"></span>
</div>



<!--To Read QR Code-->
<script type="text/javascript" src="JS/qrReader.js"></script>
              
          </div>

      
        </div>
      </div>
    
</body>
</html>